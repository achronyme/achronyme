// Circuit: secret voting — eligibility + privacy + uniqueness + validity
// Proves: voter is registered (Merkle), nullifier prevents double-vote,
// and vote is 0 or 1.

public merkle_root
public nullifier
public vote
public election_id
witness secret
witness path[2]
witness indices[2]: Bool

// 1. Voter commitment (hidden — computed from private secret)
let commitment = poseidon(secret, 0)

// 2. Merkle membership: voter is in the registered voter tree
merkle_verify(merkle_root, commitment, path, indices)

// 3. Nullifier correctness: prevents double-voting
let expected_nullifier = poseidon(secret, election_id)
assert_eq(expected_nullifier, nullifier)

// 4. Vote validity: must be 0 or 1
range_check(vote, 1)
