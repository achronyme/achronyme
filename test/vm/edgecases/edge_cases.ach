// Edge cases: large ints, deep nesting, nil/bool, various corner cases

// Empty map literal {}
let x = {}
assert(typeof(x) == "Map")
assert(len(x) == 0)

// Truncating integer division
assert(7 / 2 == 3)
assert(15 / 3 == 5)
assert(10 / 4 == 2)

// Falsey values in conditions
let a = if false { 1 } else { 0 }
assert(a == 0)
let b = if nil { 1 } else { 0 }
assert(b == 0)

// Truthy values
let d = if 1 { 1 } else { 0 }
assert(d == 1)
let e = if "hello" { 1 } else { 0 }
assert(e == 1)
let f = if true { 1 } else { 0 }
assert(f == 1)

// Large integers
let big = 1000000
assert(big * 1000 == 1000000000)

// Deeply nested expressions
assert(((((1 + 2) * 3) - 4) * 5) == 25)

// Chained else if expression
let val = if false {
    1
} else if true {
    42
} else {
    99
}
assert(val == 42)

// String equality
assert("abc" == "abc")
assert("abc" != "def")

// nil comparisons
assert(nil == nil)
assert(!(nil != nil))

// Boolean identity
assert(true == true)
assert(false == false)
assert(true != false)

// Block evaluates to last expression
let blk = { 1 + 2 }
assert(blk == 3)

// Empty block
let empty_blk = {}
assert(typeof(empty_blk) == "Map")

// Chained function calls
fn id(x) { x }
assert(id(id(id(42))) == 42)

// Moderately large computation
mut total = 0
mut i = 0
while i < 100 {
    total = total + i
    i = i + 1
}
assert(total == 4950)

print("PASS: edge_cases")
