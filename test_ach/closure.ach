fn make() {
   mut x = 0;
   fn inc() { x = x + 1; return x; }
   return inc;
}

print("--- Counter Test ---");
mut f = make();
print(f()); // Expect 1
print(f()); // Expect 2

print("--- Shared Upvalue Test ---");
mut g_get = nil;
mut g_set = nil;

fn setup_shared() {
    mut a = 10;
    fn get() { return a; }
    fn set(val) { a = val; }
    
    // Assign to globals
    g_get = get;
    g_set = set;
}

setup_shared();
print(g_get()); // Expect 10
g_set(42);
print(g_get()); // Expect 42
